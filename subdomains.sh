#! /usr/bin/bash
echo -e "\e[31m

                                                                                                      
                                                 ▒▓▓▒▒                                                
                                                 ███████▓▒                                            
                                       ▒▓  ▒▒   ▒███████▓▓█▓▒                                         
                                      ▓▓  ▓█    ██████████ ▓██▒                                       
                                     █▓  ▓█▓   ▓███████████ ███▒                                      
                                    ▓█   ██   ▒▒▒▒▒▓▓██████▓████                                      
                                   ▒██  ▒▓  ▒▓████████▓█████████▓                                     
                                   ▓██   ▒▓█▓▒  ▒▒▒▒▒▓▓██████████                                     
                                   ██▓ ▒▓▒  ▒▓████████▓▓▓▓███████▒                                    
                                  ▓█▓▒▓  ▒▓███████████████▓▓▓████▓                                    
                                 ▒█▒▒ ▒▓█████████████▓▓▒▒  ▒▒▓▓█▓▓▓                                   
                                 ▓  ▒█▓▓██████████▒          ▒█▓▓▓█▒                                  
                                ▒ ▒███▒ ▓▓▓▓██████▒       ▒▒▒ ██▓▓██                                  
                                 ▓████   ███▓▓▓▓▓█▒ ▒▒▓▓████▒ ▓███▒██                                 
                                ▒▓▓███▒█▒▒█████▒▓█▒  ▓████▓▒  ▓████▒█▒                                
                                ▓████▓▒███████████▒         ▓▒▓████▒█▓                                
                                ▓█████▒▓██████████▒      ▒▒▓▒▒████▓▒█▓                                
                                 ▓█████▓▓▓▓▓██████▒      ▒▓▓█████▒▓▓█                                 
                                  ▒████▓██▒▓███████▒   ▒ ▒██▓███▒▒▒█                                  
                                    ████▓█▒▒▒████▓▒▒  ▒  ▒█████  ▒▓                                   
                               ▒▓▓▒  ▒████▓  ▓████▓▓     ▓███▓  ▓▓▓▓▒                                 
                           ▒▓█████▓▒▓  ▓████▒ █▓██▓    ▒████▓ ▒▓▓██████▓▒                             
                        ▒███████████▒▓▒ ▒█████ ▒██▒  ▒██▓█▓▒▒█▓▓███████████▓                          
                          ▒▓█████████▒▓▓ ▒████▓▓██▓▓████▓▓▒▓█▓██████████▓▒                            
                             ▒▓█▓▓████▓▒█▒ ██▓▓▓██████▓▓▓▓██▓████████▓▒                               
                                 ▒▓████▓ ▓▒▒█▓▓▓▓██▓▓█▓▓▓█▓▓█████▓▓▒                                  
                                    ▒▓██▓ ▓ ▓▒▓▓▓█▓▓▓█▓▒█▓▓███▓▒                                      
                                       ▒▓▓  ▓▒▓▓▒▓ ▓▓█▓▓▓▓█▓▒                                         
                                            ▓▒▓▓▒▓ ▓▓█▓▓▒▒                                            
                                            ▓▒▒▒▒▓ ▓  ▓                                               
                                            ▓▒▒▒ ▓ ▒  ▒                                               
                                            ▒▒▒  ▓    ▒                                               
                                             ▒▒  ▒    ▒                                               
                                              ▒                                                       
                                                                                                      
\e[0m"
echo "


               ▓█████▄  ▒█████   ███▄ ▄███▓  ██████  ███▄    █  ██▓ ██▓███  ▓█████ 
               ▒██▀ ██▌▒██▒  ██▒▓██▒▀█▀ ██▒▒██    ▒  ██ ▀█   █ ▓██▒▓██░  ██▒▓█   ▀ 
               ░██   █▌▒██░  ██▒▓██    ▓██░░ ▓██▄   ▓██  ▀█ ██▒▒██▒▓██░ ██▓▒▒███   
               ░▓█▄   ▌▒██   ██░▒██    ▒██   ▒   ██▒▓██▒  ▐▌██▒░██░▒██▄█▓▒ ▒▒▓█  ▄ 
               ░▒████▓ ░ ████▓▒░▒██▒   ░██▒▒██████▒▒▒██░   ▓██░░██░▒██▒ ░  ░░▒████▒
                ▒▒▓  ▒ ░ ▒░▒░▒░ ░ ▒░   ░  ░▒ ▒▓▒ ▒ ░░ ▒░   ▒ ▒ ░▓  ▒▓▒░ ░  ░░░ ▒░ ░
                ░ ▒  ▒   ░ ▒ ▒░ ░  ░      ░░ ░▒  ░ ░░ ░░   ░ ▒░ ▒ ░░▒ ░      ░ ░  ░
                ░ ░  ░ ░ ░ ░ ▒  ░      ░   ░  ░  ░     ░   ░ ░  ▒ ░░░          ░   
                  ░        ░ ░         ░         ░           ░  ░              ░  ░
                ░                                                                  

"
echo ""
echo "
==========================================================================================================================================================================================================="
echo ""
echo -e "\e[1mDomSnipe\e[0m \e[91mis a powerful bash script tool designed for efficient and comprehensive discovery of subdomains associated with a specified domain.\e[0m"
echo ""
echo "::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::"
echo -e "# \e[1mProduct Information\e[0m"
echo "# Tool Name: DomSnipe"
echo "# Version: 1.0"
echo "# Developer: Anoop"
echo "# Description: DomSnipe is an advanced bash script tool. It offers robust capabilities for discovering subdomains associated with any specified domain, providing comprehensive results efficiently."
echo "# Features: Efficient subdomain discovery, customizable domain scanning, robust bash script architecture."
echo "# Usage: bash <filename> or ./ <filename> Example: bash script.sh"
echo "::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::"
echo "
==========================================================================================================================================================================================================="
echo ""
spinner() {
    local pid=$!
    local delay=0.1
    local spinstr='|/-\'
    tput civis  # Hide the cursor
    while [ "$(ps a | awk '{print $1}' | grep $pid)" ]; do
        local temp=${spinstr#?}
        printf " [%c]  " "$spinstr"
        local spinstr=$temp${spinstr%"$temp"}
        sleep $delay
        printf "\b\b\b\b\b\b"
    done
    tput cnorm  # Show the cursor
    printf "    \b\b\b\b"
}

display_end_message() {
    local message="$1"
    local color_message="$2"
    local delay=0.1
    for ((i=0; i<${#message}; i++)); do
        printf "${message:$i:1}"
        sleep $delay
    done
    echo -e "$color_message"
}

is_valid_domain() {
    local domain=$1
    if [[ $domain =~ ^[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z]{2,})+$ ]]; then
        return 0
    else
        return 1
    fi
}

while true; do
    read -p "Enter your domain: " domain
    if is_valid_domain "$domain"; then
        break
    else
        echo "Invalid domain. Please enter a valid domain."
    fi
done

read -p "You entered the domain '$domain'. Do you want to proceed? (y/n): " confirm
if [ "$confirm" == "y" ]; then
    echo "Finding subdomains..."
    assetfinder $domain > subdomains & spinner
    wait # Wait for the background process to finish

    read -p "Do you want to scan for live subdomains? (y/n): " scan_confirm
    if [ "$scan_confirm" == "y" ]; then
        echo "Scanning for live subdomains..."
        cat subdomains | httprobe > live & spinner
        wait # Wait for the background process to finish
    else
        echo "Skipping live subdomains scan."
        touch live  # Ensure live file exists even if not scanning
    fi

    read -p "Do you want to sort the live subdomains? (y/n): " sort_confirm
    if [ "$sort_confirm" == "y" ]; then
        echo "Sorting live subdomains..."
        sort -u live > sorted & spinner
        wait # Wait for the background process to finish
    else
        echo "Skipping sorting of live subdomains."
        cp live sorted  # Ensure sorted file exists even if not sorting
    fi

    echo "Displaying sorted subdomains:"
    cat sorted | nl

    # Prompt user to choose a subdomain to open
    read -p "Do you want to open a subdomain? (y/n): " open_confirm
    if [ "$open_confirm" == "y" ]; then
        while true; do
            read -p "Enter the number of the subdomain to open: " num
            subdomain=$(sed -n "${num}p" sorted)
            if [ -n "$subdomain" ]; then
                echo "Opening $subdomain..."
                xdg-open "http://$subdomain" 2>/dev/null || open "http://$subdomain" 2>/dev/null || start "http://$subdomain"
                break
            else
                echo "Invalid selection. Please try again."
            fi
        done
    else
        echo "Skipping opening of subdomains."
    fi

else
    echo "Operation cancelled."
fi

echo ""
end_message="Thank you for using "
color_message="\e[1;31mDomSnipe\e[0m"  # Red color
display_end_message "$end_message" "$color_message"
